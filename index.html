async function updateTimes() {
    const stopId = "4134"; // Oberlaa
    try {
        const url = "https://www.wienerlinien.at/ogd_realtime/monitor?rbl=" + stopId;
        const res = await fetch("https://api.allorigins.win/raw?url=" + encodeURIComponent(url));
        const data = await res.json();

        const monitors = data.data?.monitors;
        if (!monitors || monitors.length === 0) return;

        const lines = monitors[0].lines;
        const u1 = lines.find(l => l.name === "U1");
        if (!u1) return;

        const deps = u1.departures.departure;

        for (let i = 0; i < 4; i++) {
            const dep = deps[i];
            const el = document.getElementById("t" + (i+1));

            if (!dep) {
                el.innerText = "--:--";
                continue;
            }

            // Nutze zuerst timeReal, sonst timePlanned
            let timeStr = dep.departureTime?.timeReal || dep.departureTime?.timePlanned;

            if (!timeStr) {
                el.innerText = "--:--";
                continue;
            }

            // ISO-Zeit parsen
            const d = new Date(timeStr);
            if (isNaN(d)) {
                el.innerText = "--:--";
            } else {
                const h = String(d.getHours()).padStart(2,"0");
                const m = String(d.getMinutes()).padStart(2,"0");
                el.innerText = `${h}:${m}`;
            }
        }

    } catch(e) {
        console.log("Abfahrten Fehler:", e);
        // Optional: alle Zeiten auf --:--
        for (let i = 1; i <= 4; i++) {
            document.getElementById("t" + i).innerText = "--:--";
        }
    }
}

            
